<div class="max-w-7xl mx-auto p-6 max-md:p-4">
  <!-- Page Header -->
  <app-page-header
    title="Artistas"
    subtitle="Gerencie os artistas e bandas do catálogo"
    icon="people">
    <button mat-raised-button color="primary" (click)="createArtist()">
      <mat-icon>add</mat-icon>
      <span class="hidden md:inline">Novo Artista</span>
    </button>
  </app-page-header>

  <!-- Filters Bar -->
  <div class="flex flex-wrap gap-4 p-4 bg-white rounded-xl shadow-sm mb-6 border border-gray-100 max-md:flex-col">
    <mat-form-field appearance="outline" class="flex-1 min-w-[250px] max-md:w-full max-md:min-w-0">
      <mat-label>Buscar artista</mat-label>
      <input matInput
             [value]="searchTerm"
             (input)="onSearch($event)"
             placeholder="Digite o nome do artista">
      <mat-icon matPrefix class="text-gray-400">search</mat-icon>
      <button mat-icon-button
              matSuffix
              *ngIf="searchTerm"
              (click)="clearSearch()"
              matTooltip="Limpar busca">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>

    <mat-form-field appearance="outline" class="min-w-[150px] max-md:w-full max-md:min-w-0">
      <mat-label>Tipo</mat-label>
      <mat-select [value]="typeFilter" (selectionChange)="onTypeFilterChange($event.value)">
        <mat-option [value]="null">Todos os tipos</mat-option>
        <mat-option value="SOLO">
          <mat-icon class="text-lg mr-2 align-middle text-gray-500">person</mat-icon>
          Cantor Solo
        </mat-option>
        <mat-option value="BAND">
          <mat-icon class="text-lg mr-2 align-middle text-gray-500">groups</mat-icon>
          Banda
        </mat-option>
      </mat-select>
    </mat-form-field>

    <button mat-stroked-button
            class="flex items-center gap-0.5 min-w-0 px-4"
            (click)="onSortChange()"
            matTooltip="Ordenar {{ sortDirection === 'asc' ? 'Z-A' : 'A-Z' }}">
      <mat-icon>sort_by_alpha</mat-icon>
      <mat-icon class="text-base max-sm:hidden">{{ sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward' }}</mat-icon>
    </button>

    <button mat-button
            color="primary"
            (click)="clearFilters()"
            *ngIf="searchTerm || typeFilter">
      <mat-icon>filter_alt_off</mat-icon>
      <span class="hidden md:inline">Limpar</span>
    </button>
  </div>

  <!-- Stats Bar -->
  <div class="flex items-center mb-4 py-2" *ngIf="!loading && totalElements > 0">
    <span class="text-sm text-gray-500">
      <strong class="text-gray-900 font-semibold">{{ totalElements }}</strong> artista(s) encontrado(s)
    </span>
  </div>

  <!-- Loading State -->
  <div class="flex flex-col items-center justify-center min-h-[300px] gap-4 text-gray-500" *ngIf="loading">
    <mat-spinner diameter="48"></mat-spinner>
    <p>Carregando artistas...</p>
  </div>

  <!-- Artists Grid -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 py-6 animate-fade-in" *ngIf="!loading && artists.length > 0">
    <mat-card *ngFor="let artist of artists; let i = index"
              class="cursor-pointer relative overflow-hidden flex flex-col"
              [style.animation-delay]="i * 50 + 'ms'"
              (click)="viewArtist(artist)">
      <div class="absolute top-0 left-0 right-0 h-1 transition-all duration-150 hover:h-1.5"
           [class]="artist.type === 'BAND' ? 'bg-accent' : 'bg-primary'"></div>

      <mat-card-header class="pt-6">
        <div mat-card-avatar
             class="flex items-center justify-center w-12 h-12 rounded-xl mr-4 text-white"
             [class]="artist.type === 'BAND' ? 'bg-accent' : 'bg-primary'">
          <mat-icon class="text-2xl">{{ artist.type === 'BAND' ? 'groups' : 'person' }}</mat-icon>
        </div>
        <mat-card-title class="text-gray-900">{{ artist.name }}</mat-card-title>
        <mat-card-subtitle>
          <div class="flex items-center gap-4 flex-wrap mt-1">
            <span class="inline-flex items-center px-2.5 py-0.5 bg-gray-100 rounded-full text-xs font-medium text-gray-600">
              {{ getTypeLabel(artist.type) }}
            </span>
            <span *ngIf="artist.country" class="inline-flex items-center gap-0.5 text-sm text-gray-500">
              <mat-icon class="text-sm">place</mat-icon>
              {{ artist.country }}
            </span>
          </div>
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content class="flex-1">
        <p *ngIf="artist.biography" class="text-gray-500 text-sm leading-relaxed line-clamp-3 m-0">{{ artist.biography }}</p>
        <p *ngIf="!artist.biography" class="text-gray-400 text-sm italic m-0">Sem biografia cadastrada</p>
      </mat-card-content>

      <mat-divider></mat-divider>

      <mat-card-actions class="flex items-center px-4 py-2">
        <div class="flex items-center gap-1 text-sm text-gray-500" *ngIf="artist.albums?.length">
          <mat-icon class="text-lg text-primary">album</mat-icon>
          <span>{{ artist.albums?.length }} álbum(ns)</span>
        </div>
        <span class="flex-1"></span>
        <button mat-icon-button
                color="primary"
                (click)="viewArtist(artist); $event.stopPropagation()"
                matTooltip="Ver detalhes">
          <mat-icon>visibility</mat-icon>
        </button>
        <button mat-icon-button
                (click)="editArtist(artist); $event.stopPropagation()"
                matTooltip="Editar">
          <mat-icon>edit</mat-icon>
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <!-- Empty State -->
  <app-empty-state
    *ngIf="!loading && artists.length === 0"
    icon="music_off"
    title="Nenhum artista encontrado"
    [description]="searchTerm || typeFilter
      ? 'Nenhum artista corresponde aos filtros aplicados. Tente ajustar sua busca.'
      : 'Comece adicionando o primeiro artista ao catálogo.'"
    [actionText]="searchTerm || typeFilter ? 'Limpar filtros' : 'Adicionar artista'"
    [actionIcon]="searchTerm || typeFilter ? 'filter_alt_off' : 'add'"
    (actionClick)="searchTerm || typeFilter ? clearFilters() : createArtist()">
  </app-empty-state>

  <!-- Pagination -->
  <div class="flex justify-center mt-6 p-4 bg-white rounded-xl shadow-sm" *ngIf="totalElements > pageSize">
    <mat-paginator
      [length]="totalElements"
      [pageSize]="pageSize"
      [pageIndex]="currentPage"
      [pageSizeOptions]="pageSizeOptions"
      (page)="onPageChange($event)"
      showFirstLastButtons>
    </mat-paginator>
  </div>
</div>
